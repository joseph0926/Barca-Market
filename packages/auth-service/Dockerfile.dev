FROM node:21-alpine3.18

WORKDIR /app

# Copying necessary files for the build
COPY package.json ./
COPY tsconfig.json ./
COPY src ./src

# Copying the auth-service package
COPY packages/auth-service/package.json ./packages/auth-service/
COPY packages/auth-service ./packages/auth-service

# Install global and local dependencies
RUN npm install -g nodemon ts-node typescript npm@latest
RUN npx prisma generate
RUN npm install

# Expose the port that the app runs on
EXPOSE 4002

# Command to run the application in development mode
CMD ["npm", "run", "dev-auth"]
